#:kivy 1.10.1

<IssuesBox>:
    issues_container: _issues_container
    FieldBox:
        disabled: True if root.info_window_status == 'open' else False
        Label:
            text: 'Enter issues'
        TextInput:
            id: _issues_text
            on_text_validate: root.load_issues(_issues_text.text) if self.text else None
            text_validate_unfocus: True
            # status_bar
            default_text: "Enter the number of issues. For ongoing series, add a plus sign, eg. 13+. Enter ranges like \"25-65\", as well as single issues, eg. '0, -1, 1'. Separate with commas."
            on_focus: root.status_bar.set_status(self.default_text) if self.focus else None
        Button:
            text: 'add'
            disabled: False if _issues_text.text else True
            on_release: root.load_issues(_issues_text.text) if self.text else None
        Button:
            text: 'print issues'
            on_release: root.test()
    ScrollView:
        height: root.height - (_issues_text.height + dp(5))
        BoxLayout:
            id: _issues_container
            _root: root
            size_hint: 1, None
            height: self.minimum_height
            padding: dp(5)

<IssueSelector@FieldBox>
    size_hint_x: 1
    TextInput:
        id: _select_range_input
        text_validate_unfocus: False
        size_hint: 1, 1
        on_text_validate: root.select_issue_range(self, _standard_issues_container)
    Button:
        text: 'select range'
        on_release: root.select_issue_range(_select_range_input, _standard_issues_container)
    Button:
        text: 'all'
        on_release: root.select_all_issues(_standard_issues_container)
    Button:
        text: 'none'
        on_release: root. deselect_all_issues(_standard_issues_container)

<IssueRowBox>
    orientation: 'horizontal'
    size_hint: 1, None
    height: dp(20)
    padding: dp(5), dp(0)

<IssueInfoBox>:
    add_copy_button: _add_copy_button
    add_variant_button: _add_variant_button
    notes: _notes_text
    canvas:
        Color:
            rgba: .2, .7, .9, .5
        Line:
            width: dp(1)
            rectangle: self.x + 5, self.y + 5, self.width - 10, self.height - 10
        Color:
            rgba: .2, .7, .9, .025
        Rectangle:
            pos: self.pos
            size: self.size
    padding: dp(10)
    size_hint: 1, None
    height: self.minimum_height
    padding: dp(10), dp(10), dp(15), dp(15)
    FieldBox:
        height: self.minimum_height
        BlueLabel:
            id: _issue_name_label
            padding: dp(5), dp(0)
            text: 'Issue #' + root.issue.text if root.issue else ''
        Label:
            size_hint_x: .3
        AddExtraButton:
            id: _add_copy_button
            issue_info_container: root
#            extra_type: 'copy' NOT NEEDED as it is the default. leaving this here to avoid confusion
        AddExtraButton:
            id: _add_variant_button
            issue_info_container: root
            extra_type: 'variant'
    FieldBox:
        padding: dp(10), dp(0)
        height: dp(100)
        Label:
            id: _notes_label
            text: 'Notes'
            width: dp(105)
            valign: 'top'
            text_size: self.size
        TextInput:
            id: _notes_text
            multiline: True
            # status_bar
            default_text: 'Enter notes for selected issue.'
            on_focus: root.issues_box.status_bar.set_status(self.default_text) if self.focus else None
    FieldBox:
        padding: dp(10), dp(0)
        height: dp(64)
        valign: 'bottom'
        FieldLabel:
        Button:
            size_hint_y: .5
            text: 'cancel'
            on_release: root.close_window(root.parent)
        Button:
            size_hint_y: .5
            text: 'save & close'
            on_release: root.save_changes()

<AddExtraButton>:
    extra_type: 'copy'
    font_name: 'fonts/ComicBook.otf'
    font_size: sp(15.5)
    size_hint_x: .35
    on_release: self.issue_info_container.add_extra_box(self.text[4:]) if self.state == 'down' else self.issue_info_container.remove_extra_box(self.extra_type)

<ExtraIssueBox>:
    number_label: _number_label
    note: _extra_note_text
    size_hint: 1, None
    height: self.minimum_height
    padding: dp(10), 0
    FieldBox:
        Label:
            id: _number_label
            text: root.box_label
            width: dp(105)
            text_size: self.size
            shorten: True
            shorten_from: 'right'
        FieldBox:
            size_hint_x: 1
            TextInput:
                id: _extra_note_text
                focus: True
                on_text_validate: self.get_focus_next().focus = True if self.text else False
                copy_status_msg: 'Enter copy description and/or location information.'
                variant_status_msg: 'Enter name of variant.'
                on_focus: root.issues_box.status_bar.set_status(self.copy_status_msg if root.extra_type == 'copy' else self.variant_status_msg) if self.focus else None
            TextButton:
                text: 'X'
                font_name: 'fonts/ComicBook.otf'
                size_hint: None, 1
                width: self.texture_size[0]
                on_release: root.remove_me()

